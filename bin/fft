#!/usr/bin/env python

import sys, os, matplotlib, pylab, h5py, numpy
sys.path.append("lib")

from fdtd.utils import fft, prepare, open, plot
from os.path import dirname, basename

hdf5 = h5py.File(sys.argv[1], "r")
outdir = dirname(sys.argv[1])+"/fftcharts"
prepare(outdir)

shape = list(hdf5["timeline/1/ex"].shape)
shape.append(len(hdf5["timeline"]))
twister = numpy.zeros(shape)
print twister.shape

(x,timelength) = twister.shape
for t in range(timelength):
    for i in range(x):
        twister[i,t] = hdf5["timeline"][str(t)].get("ex")[i]

space = twister.tolist()
print len(space)
print space[0]

for i in range(len(space)):
    plot(numpy.array(space[i]), "%s/space-%d.png", (outdir, i))

open(outdir)
